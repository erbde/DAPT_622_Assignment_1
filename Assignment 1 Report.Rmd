---
title: "DAPT 622 Assignment 1"
author: "Daniel Erb"
date: "January 14, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---

```{r Load Libraries and Arrange Data, message = FALSE}
#library(knitr)
library(kableExtra)
library(magrittr)
library(DT)
library(dplyr)
library(corrplot)

candy_data <- read.table("G:/My Drive/vcu/Spring 2019/Statistics/Assignments/Assignment 1/DAPT_622_Assignment_1/Assignment_Materials/CandyBars.txt",sep=',',header=TRUE)

cd_sub <- candy_data[,c("Oz.pkg","Calories","Total.fat.g"
                  ,"Saturated.fat.g","Cholesterol.g"
                  ,"Sodium.mg","Carbohydrate.g"
                  ,"Dietary.fiber.g","Sugars.g"
                  ,"Protein.g","Vitamin.A..RDI"
                  ,"Vitamin.C..RDI","Calcium..RDI"
                  ,"Iron..RDI")]

```

# Part 1 - Exploratory Data Analysis

## Question 1

Perform the following exploratory data analysis tasks: 

1. Consider all of the numeric variables (i.e. all of the variables except Brand and Name): Determine the variance/covariance matrix and the correlation matrix of these variables.  Interpret briefly what you see.

```{r Generate Matrices, message = FALSE}

#Get variance-covariance matrix
covmat <- cov(cd_sub)
kable(covmat,caption = "Variance/Covariance Matrix for Candy Data", digits = 3) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),
                full_width = TRUE, font_size = 10)

#Get correlation matrix
corrmat <- cor(cd_sub)
kable(corrmat,caption = "Correlation Matrix for Candy Data", digits = 3) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),
                full_width = TRUE, font_size = 10)

```
***
The variance/covariance matrix and correlation matrix show several positive correlations of note. For example, higher calorie counts tends to be associated with higher levels of total fat, saturated fat, carbohydrates, dietary fiber, sugars, and protein. Total fat, saturated fat and cholesterol are each positively correlated with one another. Protein correlates positively with total fat as well as dietary fiber, but interestingly is not very correlated with saturated fat or cholesterol. Vitamin A, Vitamin C, Calcium, and Iron are all positively correlated to one another to some extent.

There are very few negative correlations within the candy bar data set. Those negative correlations that do exist are of less magnitude than many of the positive correlations. The strongest negative correlation (-0.305) exists between carbohydrates and cholesterol. Other negative correlations are below -0.25 but do tend to be between vitamins and either carbohydrates, sugars, total fat, saturated fat, or calories. 

## Question 2

2. Construct a scatterplot matrix of the variables specified in #1. Comment on what you observe. 

```{r Generate Scatterplot Matrix, message = FALSE}

pairs(~Oz.pkg
      +Calories
      +Total.fat.g
      +Saturated.fat.g
      +Cholesterol.g
      +Sodium.mg
      +Carbohydrate.g
      +Dietary.fiber.g
      +Sugars.g
      +Protein.g
      +Vitamin.A..RDI
      +Vitamin.C..RDI
      +Calcium..RDI
      +Iron..RDI
      ,data = cd_sub
      #,lower.panel=panel.smooth, upper.panel=panel.cor
      #,pch=20
      , gap = .2
      , main="Candy Scatterplot Matrix")


```

The scatterplot matrix for the candy bar data shows several noteworthy patterens. Ounces could potentially have a linear relationship with carbohydrates. Calories seems to have a linear relationship with total fat. Total fat also seems to be linearly related to saturated fat and protein. Carbohydrates also seem linearly related to sugar. Other relationships may be difficult to assess from a scatterplot with so many attributes represented.

## Question 3

3. Construct a color map on correlations for the variables specified in #1. Comment on what you observe.

```{r Color Map Creation} 

corrmat <- cor(cd_sub)
corrplot(corrmat,method="color")

```

The color map of the correlations show very similar results as the variance/covariance and correlation matrices. They are quite a few strongly positive correlations. There are also far fewer strong negative correlations.

## Question 4

4. Use a probability plot to assess the multivariate normality of the variables specified in #1.  Interpret.

```{r Probability Plot Creation}
   

```

---
*Thanks!*
